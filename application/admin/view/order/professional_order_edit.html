<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5shiv.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="_INDEX_/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="_ADMIN_/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="_LIB_/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="_ADMIN_/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="_ADMIN_/css/style.css" />
<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
<title>编辑人员费订单 - 订单管理</title>
<meta name="keywords" content="">
<meta name="description" content="">
</head>
<body>
<article class="page-container">
	<form class="form form-horizontal" id="form-admin-add">
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>新人手机号:</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" placeholder=""  id="user_phone" name="user_phone" value="{$order.user_phone}">
			<input type="hidden" name="id" value="{$order.id}" />
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>新人姓名:</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" placeholder="" disabled id="" name="user_name" value="{$order.user_name}">
			<input type="hidden" name="id" value="{$order.id}" />
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3">新人角色：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" placeholder="" disabled value="{$sex[$user.sex]}">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>新人手机号：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplezfte="off" disabled value="{$order.user_phone}" id="mobile" name="user_phone">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3">订单类型：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" disabled value="人员费订单">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>婚礼人手机号：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" value="{$order.linkman_phone}" id="linkman_phone" name="linkman_phone">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>婚礼人：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" disabled value="{$order.linkman_name}" id="linkman_name" name="linkman_name">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>婚礼人手机号：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" disabled value="{$order.linkman_phone}" placeholder="" id="linkman_phone" name="linkman_phone">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>服务：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<span class="select-box" style="width:150px;">
			<select class="select valid" size="1" aria-invalid="false" name="service_id" id="service_id">
				{foreach name="service" item='v' key='k'}
	            <option value="{$k}"{if condition="$k eq $order.service_id"}selected{/if}>{$v}</option>
	            {/foreach}
	        </select>
			</span>
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>新人备注：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" value="{$order.user_mark}" placeholder="" id="user_mark" name="user_mark">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3">订单状态：</label>
		<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
			<select class="select" size="1">
				{foreach name="order_state" item='v' key='k'}
	            <option value="{$k}"{if condition="$k eq $order.state"}selected{/if}>{$v}</option>
	            {/foreach}
			</select>
			</span> </div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>接待顾问：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" value="{$order.activer_name}" placeholder="" id="activer_name" name="activer_name">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>人员费总计：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" placeholder="" id="total" name="total" value="{$order.total}">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>服务时间：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" value="{$order.service_time|date="Y-m-d",###}" placeholder="" id="marry_date" name="service_time">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3">宴会类型：</label>
		<div class="formControls col-xs-8 col-sm-9"> <span class="select-box" style="width:150px;">
			<select class="select" name="banquet_type" size="1">
				<option value="0">不确定</option>
	            <option value="1"{if condition="1 eq $order.banquet_type"}selected{/if}>午宴</option>
	            <option value="2"{if condition="2 eq $order.banquet_type"}selected{/if}>晚宴</option>
			</select>
			</span> </div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>酒店：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" value="{$order.hotel}" placeholder="" id="hotel" name="hotel">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>详细地址：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" value="{$order.address}" placeholder="" id="address" name="address">
		</div>
	</div>
	<div class="row cl">
		<label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>备注：</label>
		<div class="formControls col-xs-8 col-sm-9">
			<input type="text" class="input-text" autocomplete="off" value="{$order.user_mark}" placeholder="" id="user_mark" name="user_mark">
		</div>
	</div>

	<div class="row cl">
		<div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
			<input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;保存订单&nbsp;&nbsp;">
		</div>
	</div>
	</form>
</article>

<!--_footer 作为公共模版分离出去--> 
<script type="text/javascript" src="_LIB_/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="_LIB_/layer/2.4/layer.js"></script>
<script type="text/javascript" src="_INDEX_/js/H-ui.min.js"></script> 
<script type="text/javascript" src="_ADMIN_/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="_LIB_/jquery.validation/1.14.0/jquery.validate.js"></script> 
<script type="text/javascript" src="_LIB_/jquery.validation/1.14.0/validate-methods.js"></script> 
<script type="text/javascript" src="_LIB_/jquery.validation/1.14.0/messages_zh.js"></script> 
	<script type="text/javascript" src="_LAYDATE_/laydate.js"></script> 
<script type="text/javascript">
$("#linkman_id").change(function(){
	var professional_id = $(this).val();
	//获取职业人服务
	$.ajax({
                cache: true,
                type: "POST",
                url:'{:URL('service/getService')}?professional_id='+professional_id,
                data:$('#yourformid').serialize(),// 你的formid
                async: false,
                dataType:'json',
                error: function(request) {
                    alert("Connection error");
                },
                success: function(data) {
                	var htm = '';

                	if(data){
                		$.each(data, function(i, value) {
						   //this;   //this指向当前属性的值
						   //name;   //name表示Object当前属性的名称
						   //value;   //value表示Object当前属性的值
						   htm = htm+'<option value="'+i+'">'+value+'</option>';
						});
                	}
                    $("#service_id").html(htm);
                }
            });
	//获取职业人基本信息
	$.ajax({
                cache: true,
                type: "POST",
                url:'{:URL('professional/getProfessional')}?professional_id='+professional_id,
                data:$('#yourformid').serialize(),// 你的formid
                async: false,
                dataType:'json',
                error: function(request) {
                    alert("Connection error");
                },
                success: function(data) {
                	$("#linkman_phone").val(data.mobile);
                	$("#linkman_name").val(data.name);
                }
            });
});

//获取服务对应价格
$("#service_id").click(function(){
	var service_id = $(this).val();
	$.ajax({
                cache: true,
                type: "POST",
                url:'{:URL('service/getServicePrice')}?service_id='+service_id,
                data:$('#yourformid').serialize(),// 你的formid
                async: false,
                dataType:'json',
                error: function(request) {
                    alert("Connection error");
                },
                success: function(data) {
                	$("#total").val(data.price);
                }
            });
});
 			
//日历使用2
	
		var time = {
		  elem: '#marry_date',
		  event: 'focus',
		  format: 'YYYY-MM-DD', //日期格式
		  //istime: true, //是否开启时间选择
		  //min: laydate.now(), //最大日期
		  istoday: true,
		  choose: function(datas){
		  }
		};
		laydate(time);
$(function(){
	$('.skin-minimal input').iCheck({
		checkboxClass: 'icheckbox-blue',
		radioClass: 'iradio-blue',
		increaseArea: '20%'
	});
	
	$("#form-admin-add").validate({
		rules:{
			professional_id:{
				number:true,
			},
			user_id:{
				number:true,
			},
			service_id:{
				number:true,
			},
		},
		onkeyup:false,
		focusCleanup:true,
		success:"valid",
		submitHandler:function(form){
			$.ajax({  
				type: 'POST',  
				dataType : "json",
				async:true,//是否异步请求
				url: "{:URL('order/professional_order_edit')}",//请求的action路径页面
				data: $('form').serialize(),  
				error: function(){ //请求失败处理函数
					layer.msg('请求失败',{icon:1,time:1000});
				},
				success:function(data){ //请求成功后处理函数。
					layer.msg(data.msg,{icon:1,time:1000});
				}  
			});
			var index = parent.layer.getFrameIndex(window.name);
			parent.$('.btn-refresh').click();
			setTimeout(function(){parent.layer.close(index);},2000);
		}
	});
});
</script> 
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>