<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="UTF-8">
    <script type="text/javascript" src="_JS_/jquery.js"></script>
    <script language="javascript" src="_JS_/LodopFuncs.js"></script> 
</head>
<body>
<object  id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0>  
       <embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0></embed> 
	</object> 
	<button id="print" style="color:red;width:100px;font-size:20px">打印小票</button>
	<h1>以下为小票样式</h1>
	<hr />
	<table style="font-size:12px;width:80%">
	    <tr>
	        <td colspan="2">贵宾卡号：{$member.card_no}</td>
	    </tr>
	    <tr>
	        <td colspan="2">贵宾姓名：{$member.name}</td>
	    </tr>
	    <tr>
	        <td colspan="2">充值前剩余金额：{$before_recharge.last_balance}</td>
	    </tr>
	    <!--<tr>
	        <td colspan="2">充值前欠款金额：0</td>
	    </tr>-->
	    <tr>
	        <td colspan="2">充值应收金额：{$before_recharge.should_money}</td>
	    </tr>
	    <tr>
	        <td colspan="2">充值欠款金额：{$before_recharge.arrears_money}</td>
	    </tr>
	    <tr>
	        <td colspan="2">最新余额</td>
	    </tr>
	    <tr>
	        <td colspan="2">{if condition="$wallet_type==7"}储值账户{/if}{if condition="$wallet_type==8"}电子钱包账户{/if}{if condition="$wallet_type==9"}老疗程账户{/if}余额：{if condition="$wallet_type==7"}{$wallet.cash}{/if}{if condition="$wallet_type==8"}{$wallet.ewallet}{/if}{if condition="$wallet_type==9"}{$wallet.old_cash}{/if}</td>
	    </tr>
	    <tr>
	        <td colspan="2">{if condition="$wallet_type==7"}储值账户{/if}{if condition="$wallet_type==8"}电子钱包账户{/if}{if condition="$wallet_type==9"}老疗程账户{/if}欠款：{if condition="$wallet_type==7"}{$wallet.cash_arrears}{/if}{if condition="$wallet_type==8"}0{/if}{if condition="$wallet_type==9"}{$wallet.old_cash_arrears}{/if}</td>
	    </tr>
	    <tr>
	        <td colspan="2">手工单号：{$cashier.number}</td>
	    </tr>
	    <tr>
	        <td colspan="2">单据日期：{$cashier.time|date="Y/m/d h:i:s",###} 收银</td>
	    </tr>
	    <tr>
	        <td colspan="2">收银员：{$Think.session.family_name}</td>
	    </tr>
	    <tr>
	        <td colspan="2">公司地址：{$company.address}</td>
	    </tr>
	    <tr>
	        <td colspan="2">公司电话：{$company.telephone}</td>
	    </tr>
	    <tr>
	        <td colspan="2">客户签字：</td>
	    </tr>
	    <tr>
	        <td colspan="2"></td>
	    </tr>
	    <tr>
	    	<td colspan="6">扫码下载APP</td>
	    </tr>
	    <tr>
	    	<td colspan="6"><img src='\static\Images\222.png' style="width:140px;height:140px;" /></td>
	    </tr>
    </table>
</body>
</html>
<script type="text/html" id="dv1">
<table style="font-size:12px;width:80%">
	    <tr>
	        <td colspan="2">贵宾卡号：{$member.card_no}</td>
	    </tr>
	    <tr>
	        <td colspan="2">贵宾姓名：{$member.name}</td>
	    </tr>
	    <tr>
	        <td colspan="2">充值前剩余金额：{$before_recharge.last_balance}</td>
	    </tr>
	    <!--<tr>
	        <td colspan="2">充值前欠款金额：0</td>
	    </tr>-->
	    <tr>
	        <td colspan="2">充值应收金额：{$before_recharge.should_money}</td>
	    </tr>
	    <tr>
	        <td colspan="2">充值欠款金额：{$before_recharge.arrears_money}</td>
	    </tr>
	    {volist name="cpw" id="c" }
	    <tr>
	        <td>{$c.pay_name}</td>
	        <td>{$c.money}</td>
	    </tr>
	    {/volist}
	    <tr>
	        <td colspan="2">最新余额</td>
	    </tr>
	    <tr>
	        <td colspan="2">{if condition="$wallet_type==7"}储值账户{/if}{if condition="$wallet_type==8"}电子钱包账户{/if}{if condition="$wallet_type==9"}老疗程账户{/if}余额：{if condition="$wallet_type==7"}{$wallet.cash}{/if}{if condition="$wallet_type==8"}{$wallet.ewallet}{/if}{if condition="$wallet_type==9"}{$wallet.old_cash}{/if}</td>
	    </tr>
	    <tr>
	        <td colspan="2">{if condition="$wallet_type==7"}储值账户{/if}{if condition="$wallet_type==8"}电子钱包账户{/if}{if condition="$wallet_type==9"}老疗程账户{/if}欠款：{if condition="$wallet_type==7"}{$wallet.cash_arrears}{/if}{if condition="$wallet_type==8"}0{/if}{if condition="$wallet_type==9"}{$wallet.old_cash_arrears}{/if}</td>
	    </tr>
	    <tr>
	        <td colspan="2">手工单号：{$cashier.number}</td>
	    </tr>
	    <tr>
	        <td colspan="2">单据日期：{$cashier.time|date="Y/m/d h:i:s",###} 收银</td>
	    </tr>
	    <tr>
	        <td colspan="2">收银员：{$Think.session.family_name}</td>
	    </tr>
	    <tr>
	        <td colspan="2">公司地址：{$company.address}</td>
	    </tr>
	    <tr>
	        <td colspan="2">公司电话：{$company.telephone}</td>
	    </tr>
	    <tr>
	        <td colspan="2">客户签字：</td>
	    </tr>
	    <tr>
	        <td colspan="2"></td>
	    </tr>
	    <tr>
	    	<td colspan="6">扫码下载APP</td>
	    </tr>
	    <tr>
	    	<td colspan="6"><img src='\static\Images\222.png' style="width:140px;height:140px;" /></td>
	    </tr>
    </table>
</script>
<script>
//var LODOP=getLodop();
//LODOP.PRINT_INIT("打印任务名");               //首先一个初始化语句
//LODOP.SET_PRINT_PAGESIZE(3,450,200,0);  
//LODOP.ADD_PRINT_TEXT(0,0,200,20,"文本内容SDF一");//然后多个ADD语句及SET语句 
//LODOP.PRINT();                               //最后一个打印(或预览、维护、设计)语句
function refreshData(){ //让innerHTML获取的内容包含input和select(option)的最新值
		var allInputObject=document.body.getElementsByTagName("input");
		for (i = 0; i < allInputObject.length; i++) {
			if(allInputObject[i].type=="checkbox")  {
		        	if (allInputObject[i].checked ) 
                	   	allInputObject[i].setAttribute("checked","checked"); 
                	   	else
				        allInputObject[i].removeAttribute("checked");
        	} else 	if(allInputObject[i].type=="radio")  {
		        	if (allInputObject[i].checked ) 
                	   	allInputObject[i].setAttribute("checked","checked"); 
                	   	else
				        allInputObject[i].removeAttribute("checked");
        	}else allInputObject[i].setAttribute("value",allInputObject[i].value);
		};
		for (i = 0; i < document.getElementsByTagName("select").length; i++) {
		    var sl=document.getElementsByTagName("select")[i];
		    for (j = 0; j < sl.options.length; j++) {
		    if (sl.options[j].selected) 
                     	sl.options[j].setAttribute("selected","selected");
			else sl.options[j]=new Option(sl.options[j].text,sl.options[j].value);
		    };
		};
	};    
	var LODOP; //声明为全局变量  
	$("#print").click(function(){
		myDesign1();  
	});                        
	function  myDesign1(){
		//refreshData();                  
		LODOP=getLodop();                       
		LODOP.PRINT_INIT("");                     
		//LODOP.ADD_PRINT_HTM(90,221,"50mm",245,"<!doctype html>"+document.getElementById("dv1").innerHTML);  //宽50mm                     
		//设置打印项风格
		//SET_PRINT_STYLE(strStyleName,varStyleValue)
		//strStyleName：打印风格名，风格名称及其含义如下：
		//“FontName”：设定纯文本打印项的字体名称。
		//“FontSize”：设定纯文本打印项的字体大小。
		//“FontColor”：设定纯文本打印项的字体颜色。
		//“Bold”：设定纯文本打印项是否粗体。
		//“Italic”：设定纯文本打印项是否斜体。
		//“Underline”：设定纯文本打印项是否下滑线。
		//“Alignment”：设定纯文本打印项的内容左右靠齐方式。
		//“Angle”：设定纯文本打印项的旋转角度。
		//“ItemType”：设定打印项的基本属性。
		//“HOrient”：设定打印项在纸张内的水平位置锁定方式。
		//“VOrient”：设定打印项在纸张内的垂直位置锁定方式。
		//“PenWidth”：线条宽度。
		//“PenStyle”：线条风格。
		//“Stretch”：图片截取缩放模式。
		//“PreviewOnly”:内容仅仅用来预览。
		//“ReadOnly”:纯文本内容在打印维护时，是否禁止修改。

		LODOP.SET_PRINT_STYLEA(0,"Horient",2);  
		//LODOP.SET_PRINT_STYLE("Bold",1); 
		//设置纸张大小
		//SET_PRINT_PAGESIZE(intOrient, PageWidth,PageHeight,strPageName)
		//intOrient：
		//打印方向及纸张类型，数字型，
		//1---纵(正)向打印，固定纸张；
		//2---横向打印，固定纸张；
		//3---纵(正)向打印，宽度固定，高度按打印内容的高度自适应；
		//0(或其它)----打印方向由操作者自行选择或按打印机缺省设置；
		//PageWidth：
		//设定自定义纸张宽度，整数或字符型，整数时缺省长度单位为0.1毫米。字符型时可包含单位名：in(英寸)、cm(厘米)、mm(毫米)、pt(磅)、px(1/96英寸)，如“10mm”表示10毫米。
		//纸张宽，单位为0.1mm譬如该参数值为45，则表示4.5mm,计量精度是0.1mm。
		//PageHeight：
		//固定纸张时设定纸张高；高度自适应时设定纸张底边的空白高。整数或字符型，整数时缺省长度单位为0.1毫米。字符型时可包含单位名：in(英寸)、cm(厘米)、mm(毫米)、pt(磅)、px(1/96英寸)，如“10mm”表示10毫米。
		//高小于等于0时strPageName才起作用。
		//strPageName：
		//所选纸张类型名，字符型。不同打印机所支持的纸张可能不一样，这里的名称同操作系统内打印机属性中的纸张名称，支持操作系统内的自定义纸张。
		LODOP.SET_PRINT_PAGESIZE(3,'6cm','2cm',""); 
		 //增加超文本打印项(普通模式) 
		 //功能：增加超文本打印项，设定该打印项在纸张内的位置和区域大小，实现超文本控制打印。
		 //ADD_PRINT_HTM(Top,Left,Width,Height,strHtmlContent) 
		 //Top：
		//所增打印项在纸张内的上边距，整数或字符型，整数时缺省长度单位为px。字符型时可包含单位名：in(英寸)、cm(厘米)、mm(毫米)、pt(磅)、px(1/96英寸)、%(百分比)，如“10mm”表示10毫米。
		//Left：
		//所增打印项在纸张内的左边距，整数或字符型，整数时缺省长度单位为px。字符型时可包含单位名：in(英寸)、cm(厘米)、mm(毫米)、pt(磅)、px(1/96英寸)、%(百分比)，如“10mm”表示10毫米。
		//Width：
		//打印区域的宽度，整数或字符型，整数时缺省长度单位为px。字符型时可包含单位名：in(英寸)、cm(厘米)、mm(毫米)、pt(磅)、px(1/96英寸)、%(百分比)，如“10mm”表示10毫米。本参数可以用RightMargin关键字转义为打印区域相对于纸张的“右边距”。
		//Height：
		//打印区域的高度，整数或字符型，整数时缺省长度单位为px。字符型时可包含单位名：in(英寸)、cm(厘米)、mm(毫米)、pt(磅)、px(1/96英寸)、%(百分比)，如“10mm”表示10毫米，控件按这个值自动分页。本参数可以用BottomMargin关键字转义为打印区域相对于纸张的“下边距”。
		//strHtmlContent：
		//超文本代码内容，字符型，未限制长度。可以是一个完整的页面超文本代码，或者是一个代码段落，也可以是URL:web地址形式的URL地址。
		LODOP.ADD_PRINT_HTM("2%", "0%", "100%", "100%", document.getElementById("dv1").innerHTML);                 
		LODOP.PRINT();                    
	};         
</script>
